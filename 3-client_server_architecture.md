# Клиент-серверная архитектура

__Модель OSI__ – модель взаимодействия открытых систем (Open System Interconnection).

__Уровни OSI:__ физический, канальный, сетевой (IP), транспортный (TCP, UDP), сеансовый (L2TP, PPTP), уровень представления, прикладной уровень (POP, SMTP, RDP, HTTP).

__Уровни TCP/IP:__ уровень сетевых интерфейсов, сетевой, транспортный, прикладной

__Виды сетевых протоколов:__
- __TCP/IP__ совокупность протоколов передачи информации. Особое обозначение всей сети.
- __TCP__ гарантия качественного соединения, передачи данных и верификации их получения.
- __IP__ корректность доставки сообщений по выбранному адресу. Информация делится на пакеты.
- __MAC__ процесс верификации сетевых устройств. Все устройства содержат оригинальный MAC-адрес.
- __ICMP__ ответственен за обмен данными, но не используется для процесса передачи информации.
- __UDP__ управляет передачей данных, верификацию не проходит. Быстрее TCP. Информация передается непрерывным потоком.
- __HTTP__ протокол для передачи гипертекста, на базе которого функционируют все сайты. 
- __FTP__ протокол передачи информации из особого файлового сервера на ПК пользователя.
- __POP3__ классический протокол простого почтового соединения. Ответственен за передачу почты.
- __SMTP__ может устанавливать правила для передачи виртуальной почты. Передача и верификация доставки. Оповещения об ошибках.

## Клиент серверная архитектура
__Клиент серверная архитектура__ – тип компонентно-коннекторной архитектуры. Связь между сервером и клиентом.

- __Клиент__ - кто отправляет запрос. 
- __Сервер__ - удаленный компьютер, который умеет обрабатывать http-запросы.

Может быть __двухуровневой__ (проще, т.к. один сервер; менее надежна, повышены требования), __трехуровневой__ (сложнее, гибче, безопаснее, производительнее) и __многоуровневой__ системой.

__Преимущества:__
- Отсутствие дублирования кода. 
- Вычисления производятся на сервере, требования к клиенту снижены. 
- Данные хранятся на сервере (хорошо защищен). 
- Проще организовать контроль к доступу данных.

__Недостатки:__
- Если не работает сервер, то не работает вся вычислительная сеть. 
- Профилактика, ремонт, иногда нехватка производительности. 
- Сложность поддержки (нужен сисадмин). 
- Дороговизна оборудования.

## Протоколы:
__Протокол__ – набор правил передачи информации в сети Интернет.

__HTTP__ – HyperText Transfer Protocol (протокол передачи гипертекста). Использует TCP. 80 порт.

__HTTPS__ – Зашифрованная версия HTTP протокола. Использует протокол TLS. 443 порт.

__Версии HTTP:__
- 0.9 самая первая;
- 1.1 самая распространенная;
- 2.0 самая современная.

__TCP__ – Transmission Control Protocol (протокол управления передачей). Для пересылки своих сообщений. Гарантирует доставку данных в том же порядке в котором были отправлены. Обеспечивает надежную доставку пакетов без ошибок.

__TLS__ – Transport Layer Security (протокол защиты транспортного уровня). Использует гибридный метод шифрования: сначала ассиметричное, после симметричное шифрование.

__Handshake__ (рукопожатие) – установление контакта между клиентом и сервером (на этом этапе используется ассиметричное шифрование).

## Серии кодов статусов (ошибки)
- 1хх – __информационный__
- 2хх – __успех__
- 3хх – __редирект__ (302 найдено, 305 использовать прокси)
- 4хх – __ошибка клиента__ (400 неверный запрос, 401 неавторизован, 402 необходима оплата, 403 запрещено, 404 не найден, 405 метод не разрешён)
- 5хх – __ошибка сервера__ (501 не реализовано, 502 неверный шлюз, 503 сервис недоступен, 505 HTTP-версия не поддерживается)

## Методы HTTP запросов
Короткое английское слово, записанное заглавными буквами. 
- Описывает требуемое действие к ресурсу. 
- Название метода чувствительно к регистру. 
- Каждый сервер обязан поддерживать как минимум методы GET и HEAD.

__Безопасные методы.__ Не изменяет состояние сервера. 
- GET,
- HEAD,
- OPTIONS,
- TRACE.

__Идемпотентные методы.__ Свойство операции, при повторном применении дает тот же результат, что и при первом. Не изменяет состояние сервера. 
- GET,
- HEAD,
- OPTIONS,
- TRACE,
- PUT,
- DELETE.

__Небезопасный и неидемпотентный.__
- POST

Название	| GET	| POST
---|---|---
Данные	| Данные передаются в URL	| Данные передаются в теле запроса
Видимость	| Данные в URL видны всем	| Данные не видны в URL
Безопасность	| Менее безопасный	| Более безопасный
Добавление в закладки	| Да	| Нет
Кеширование	| Да	| Нет
История	| Остается в истории браузера	| Не остается в истории браузера
Ограничение в длине запроса	| Максимальная длина URL 2048	| Нет ограничений
Ограничение по типу данных	| Допускается использование только символов ASCII	| Не имеет ограничение. Допускаются также двоичные данные
Кнопка Назад, Перезагрузка	| Безопасно	| Данные будут отправлены вновь. Браузер предупредит, о повторной отправки данных.

## Методы HTTP запросов
- __GET.__ Безопасный. Идемпотентный. Не имеет тело запроса, но имеет тело ответа. Запрашивает ресурс.
- __POST.__ Небезопасный. Не идемпотентный. Имеет тело запроса и ответа. Передача необработанных данных на сервер. Логин и пароль.
- __HEAD.__ Безопасный. Идемпотентный. Не имеет тело запроса и ответа. Аналогичен методу GET. Запрашивает ресурс. Возвращает заголовки.
- __PUT.__ Небезопасный. Идемпотентный. Имеет тело запроса, но не имеет тело ответа. Заменяет все текущие представления ресурса данными запроса. 
- __PATCH.__ Небезопасный. Не идемпотентный. Имеет тело запроса и ответа. Частично изменяет ресурс. Аналогичен PUT, но для передачи фрагмента данных.
- __DELETE.__ Небезопасный. Идемпотентный. Может содержать тело запроса и ответа. Удаляет указанный ресурс.
- __OPTIONS.__ Безопасный. Идемпотентный. Не имеет тело запроса, но имеет тело ответа. Показывают какие HTTP-методы доступны.
- __TRACE.__ Безопасный. Идемпотентный. Не имеет тело запроса и ответа. Возвращает полученный запрос так, что клиент может увидеть, какую информацию промежуточные серверы добавляют или изменяют в запросе.
- __CONNECT.__ Небезопасный. Не идемпотентный. Не имеет тело запроса, но имеет тело ответа. Устанавливает «Туннель» к серверу, определённому по ресурсу. Запускает двухстороннюю связь.

Метод	| Имеет тело	| Успешный ответ имеет тело	| Безопасный	| Идемпотентный
---|---|---|---|---
GET	| Нет	| __Да__	| __Да__	| __Да__
HEAD	| Нет	| Нет	| __Да__	| __Да__
POST	| __Да__	| __Да__	| Нет	| Нет
PUT	 | __Да__	| Нет	| Нет	| __Да__
DELETE	| *Может*	| *Может*	| Нет	| __Да__
CONNECT	| Нет	| __Да__	| Нет	| Нет
OPTIONS	| Нет	| __Да__	| __Да__	| __Да__
TRACE	| Нет	| Нет	| __Да__	| __Да__
PATCH	| __Да__	| __Да__	| Нет	| Нет

## Запросы и ответы HTTP

__HTTP-запрос состоит:__
1. __Стартовая строка__
	- __Метод HTTP__
	- __Цель запроса__ (обычно URL или абсолютный путь протокола, порт и домен) 
	- __Версия HTTP__ (версия 1.1. самая распространенная, версия 2.0 набирает обороты)
2. __Заголовки (Headers).__ Возможно один или несколько заголовков. Значения бывают разными
	- __Host__ (имя сайта, позволяет хостить несколько сайтов на одном IP адресе) 
	- __User-Agent__ (доп. информация об исп. браузере, который должен обозначать вид используемого браузера, а на практике сложным образом описывает список технологий	который поддерживает браузер)
	- __Accept__ (определяет формат данных в ответе, который нужен клиенту)
	- __Connection__ («close» - клиент хочет закрыть TCP соединение после ответа сервера)
3. __Тело сообщения__ (Message Body). Бывает не у всех запросов: запросы, собирающие ресурсы, такие как GET, HEAD, OPTIONS, DELETE в нем обычно не нуждаются

__HTTP-ответ состоит:__
1. __Строка статуса__ (status line). Стартовая строка ответа HTTP, называемая строкой статуса:
	- __Версия протокола__, обычно HTTP/1.1.
	- __Код состояния__ (status code), показывает, был ли запрос успешным. Пример: 200, 404
	- __Пояснение__ (status text). Краткое текстовое описание кода состояния
    - Пример строки статуса: *HTTP/1.1 404 Not Found.*
2. __Заголовки.__ Строка не зависит от регистра, завершается двоеточием (':') и значение, структура которого определяется типом заголовка
3. __Тело.__ Опционально, содержит пересылаемый ресурс

## API
__API (Application programming interface).__ Программный интерфейс приложения, с помощью которого, одна программа может взаимодействовать с другой.

__Четыре способа работы API:__ SOAP, REST, RPC, Websocket.
- __RPC__ - система удаленного вызова процедур. Клиент выполняет функцию на сервере, и сервер отправляет результат обратно клиенту.
- __Websocket API.__ Двунаправленное постоянное соединение между клиентом и сервером. Протокол прикладного уровня. Порты 80/443 уровня. Постоянное соединение TCP. Использует объекты JSON для передачи данных. 
- __REST__ (Representational State Transfer). Архитектурный стиль. Не является стандартом или протоколом. Общение между клиентом и сервером с помощью обычных HTTP-запросов.
- __SOAP__ (Simple Object Access Protocol). Протокол обмена структурированными сообщениями. Использует XML-документ. Использует HTTP(S)-протокол методом POST. 
Отличия REST и SOAP это формат сообщений

REST архитектурный стиль | SOAP протокол передачи данных
---|---
Использует разные форматы (JSON, XML, text)	| Использует только XML
Использует только HTTP(S) протокол	| Использует любые протоколы (HTTP, FTP, SMTP)
Тяжелее	| Легче
Кэшируется	| Не кэшируется
Менее безопасный	| Безопасный (передает запрос в отдельном файле)
Удобнее	| Менее удобный
Быстрее	| Медленнее
Использует схему WSDL (обязательно)	| Использует аналог WADL (опционально)
Если в REST послать неизвестный параметр, то сам запрос уйдет на сервер и вы получите от сервера ошибку	| Если в SOAP попытаться послать запрос с неверным параметром, то система даже не пошлет ваш запрос, потому что такой запрос не будет соответствовать стандарту

## Отличия JSON и XML
__Структура JSON__ – ключ, значение

JSON формат обмена данными	| XML язык разметки (документа)
---|---
Читабельнее	| Менее читабелен
Легче	| Тяжелее
Короче	| Длиннее
Может использовать массивы	| Не может использовать массивы
Не использует конечный тег	| Использует конечный тег
Парситься и используется любым языком программирования. Может парситься стандартной функцией JavaScript и извлекаться при помощи XMLHttpRequest	| Приходится парсить при помощи специального XML-парсера

## XML
```
<employees>
	<employees>
		<firstName>John</firstName> <lastName>Doe</lastName>
	</employees>
	<employees>
		<firstName>Anna</firstName> <lastName>Smith</lastName>
	</employees>
	<employees>
		<firstName>Peter</firstName> <lastName>Jones</lastName>
	</employees>
<employees>
```

## JSON
```
{“employees”: [
	{“firstName”: “John”, “lastName”: “Doe”},
    {“firstName”: “Anna”, “lastName”: “Smith”},
    {“firstName”: “Peter”, “lastName”: “Jones”},
]}
```

__XML состоит из:__ Открывающий и закрывающий тег, имя элемента, атрибуты и контент. __Правила написания XML:__ только один корневой элемент, элементы имеют закрывающий тег, названия регистрозависимые, элементы не должны пересекаться, значения атрибутов в кавычках, нельзя использовать в текстовых блоках (<, >, &, ”, '). Объявление XML – первая строка.

__JSON состоит из:__ Объектов (имя: “значение”), заключенные в фигурные скобки и массивов (несколько объектов) заключенные в квадратные скобки.

## Холодный/теплый, тонкий/толстый клиент.
__Холодный клиент__ - нет никаких куки. __Теплый клиент__ - есть куки.

__Тонкий клиент__ - вычисления проходят на сервере. __Толстый клиент__ - вычисления проходят у клиента.

## VPN и Proxy разница
__VPN__
- Виртуальная приватная сеть
- Состоит из проксей
- Не может существовать без прокси
- Работает на уровне операционной системы

Плюсы: 
- Защита данных 
- Анонимность в сети 
- Обход ограничений интернет-провайдера

Минусы: 
- Задержка сети (пинг) 
- Снижение пропускной способности сети 
- Медленнее

__Прокси сервер (Proxy)__
- Промежуточное звено между клиентом и сервером
- Часть VPN. Может отдельно существовать
- Работает на уровне приложения
- Чаще случаются разрывы
- Не всегда шифрует данные
- Данные могут перехватить мошенники

## Идентификация, аутентификация и авторизация
- __Идентификация__ - процесс нахождения логина пользователя в базе данных. Проводится при сопоставлении логина. Определение что такое юзер уже есть.
- __Аутентификация__ проводится при сопоставлении пароля. Проверка пароля. Пароль подходит.
- __Авторизация__ выдача прав пользователю. Есть доступ к тому, что раньше нельзя было.

## Факторы аутентификации
- __Однофакторная__ – по паролю;
- __Двухфакторная__ – сообщение на телефон, на мыло, код в приложении;
- __Трехфакторная__ – биометрия.

## Cache, cookie, token
- __Куки__ (настройки клиента) – сохраняют всё что связанно с данными авторизации (логин, пароль).
- __Кэш__ (настройки сервера) – сохраняет информацию на повторяющихся сайтов, чтобы облегчить работу (картинки, шрифты). Хранится на компьютере.
- __Token__ – электронный ключ для доступа к службам.

## Как посмотреть cookie? 
DevTools, Application, Storage, Cookies. Можно посмотреть через вкладку Console. __Атрибуты:__ Name, Value, Domain, Path, время и дата, Size.

## URI, URL, URN
- __URI.__ Унифицированный __идентификатор__ ресурса. URI = URL + URN.
- __URL.__ Унифицированный определитель __местонахождения__ ресурса. 
- __URN.__ Унифицированное __имя__ ресурса.

__Передача параметров в URL:__ Схема, логин, пароль, хост, порт, URL-путь, параметры, якорь

__Структура URL:__ *<схема>://<логин>:<пароль>@<хост>:<порт>/<URL-путь>?<параметры>#<якорь>*

__Обязательно:__ *<схема>* __и__ *<URL-путь>* __или__ *<схема>://URL‐путь>?<параметры>#<якорь>*

## DNS
__Domain Name System (система доменных имен).__ Преобразует буквенное имя сайта в IP-адрес. Прикладной уровень. Например: *www.yandex.ru* ---> *77.88.55.66*

__Режим работы DNS:__ итеративный, рекурсивный (сервер сам выполняет запросы)

Сервер разрешения имен DNS:
1. Предоставляется провайдером (компьютер получает адрес локального сервера DNS по DHCP)
2. Открытый сервер (Google: 8.8.8.8 и 8.8.4.4, Яндекс: 77.88.8.8 и 77.88.8.7 (блокировка эротики))

Типы ответов DNS:
- авторитетный (есть доверие)
- неавторитетный (не заслуживающий доверия)

__Октаты в DNS. Октет__ - это диапазон чисел от 0 до 255, составляющих часть IP адреса. Октеты в IP разделены точкой. Пример, IP: *192.168.1.1* Первая октета - 192, вторая октета - 168.

## Веб-сайты и веб-приложения
- __Веб-сайты__ простые информационные сайты. JS, CSS, HTML. Клиент не может вносить изменения.
- __Веб-приложения__ клиент может взаимодействовать с контентом. Соцсети, переводчик. Нужна авторизация.

__IP-адрес__ – уникальный идентификатор адреса сети. IP означает «Интернет-протокол» – набор правил, регулирующих формат данных. Состоит из четырех чисел (в диапазоне от 0 до 255), которые разделены точками. На смену __IPv4__ идет протокол __IPv6__. __Статический IP__ (все четыре числа неизменны), динамический IP (числа могут меняются).

__Endpoint__ - конечная точка. Представляет собой некий шлюз, который соединяет серверные процессы приложения с внешним интерфейсом. Это адрес, на который отправляются сообщения.

__Порт__ - это просто целое число на пакете данных, который показывает, для какой программы эти данные предназначены. __Число портов__ у Linux сервера – 65 535.

__Ядро браузера__ - программа, преобразующая содержимое веб-страниц (файлы HTML, XML, цифровые изображения) и информацию о форматировании (в форматах CSS, XSL) в интерактивное изображение форматированного содержимого на экране.

## Какие браузеры какие ядра используют
- __Blink__ - движок браузера Google Chrome, Microsoft Edge, Opera;
- __Gecko__ - открытый движок проекта Mozilla;
- __WebKit__ - движок для браузера Apple Safari.

## Инкапсуляция и декапсуляция
- __Инкапсуляция__ - процесс, когда информация отправляется и переходит из данных в биты.
- __Декапсуляция__ - информация, полученная в битах на 1-вом уровне, переходит в данные на 7-мом.

## FTP
__File Transfer Protocol__ - протокол передачи файлов по сети. Прикладной протокол.

Свойство | FTP | HTTP
---|---|---
Основан на сессиях работы	| Да	| Нет
Встроена аутентификация пользователей	| Да	| Нет
Изначально предусмотрен для передачи	| Больших двоичных файлов	| Небольших текстовых файлов
Модель соединения	| Двойное подключение	| Одиночное подключение
Поддерживает текстовый и двоичный режимы передачи	| Да	| Нет
Поддерживает указание типов передаваемых данных (MIME заголовки)	| Нет	| Да
Поддерживает операции над файловой системой (mkdir, rm, rename и т.д.)	| Да	| Нет
Поддержка браузерами	| Сложно	| Да

__Отличия от HTTP:__
- Порты (FTP – 21, HTTP - 80)
- Размеры пакетов - накладные расходы при передаче по HTTP выше, чем по FTP
- FTP считается надёжней для стабильности передачи данных
- FTP не может шифровать свой траффик
